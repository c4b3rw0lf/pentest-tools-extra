#!/bin/bash

# Check if directory exists, create it if necessary
function check_directory {
    if [ ! -d $1 ]; then
        mkdir $1
    fi
}

# Clone or pull git repos
function clone_or_pull {
    if [ -d "$2/.git" ]; then
        echo "Pulling $1"
        git -C "$2" pull
    else
        echo "Cloning $1"
        git clone $1 $2
    fi
}

# Pentest directory
base_dir="/pentest"

# Categories and URLs
declare -A tools=( 
    ["exploitation"]=("https://github.com/EgeBalci/amber" "https://github.com/Mr-Un1k0d3r/DKMC" "https://github.com/TheWover/donut"
                      "https://github.com/dreadlocked/Drupalgeddon2" "https://github.com/rithchard/Drupalgeddon3"
                      "https://github.com/FSecureLABS/bsides18_breakfree" "https://github.com/00theway/Ghostcat-CNVD-2020-10487"
                      "https://github.com/fox-it/mitm6" "https://github.com/guardicore/monkey" "https://github.com/trustedsec/unicorn"
                      "https://github.com/RUB-NDS/PRET" "https://github.com/phamphuqui1998/CVE-2021-34473" "https://github.com/whitel1st/docem"
                      "https://github.com/adipinto/HP-Data-Protector-RCE" "https://github.com/pwntester/ysoserial.net"
                      "https://github.com/unipacker/unipacker" "https://github.com/trustedsec/nps_payload"
                      "https://github.com/clr2of8/Commentator" "https://github.com/plackyhacker/Suspended-Thread-Injection"
                      "https://github.com/hasherezade/libpeconv.git" "https://github.com/d35ha/CallObfuscator"
                      "https://github.com/optiv/ScareCrow" "https://github.com/pwntester/ysoserial.net"
                      "https://github.com/frohoff/ysoserial" "https://github.com/0xsp-SRD/mortar"
                      "https://github.com/S3cur3Th1sSh1t/OffensiveVBA" "https://github.com/phra/PEzor"
                      "https://github.com/DidierStevens/DidierStevensSuite/blob/master/shellcode2vba.py")
    ["info-gathering"]=("https://github.com/Tib3rius/AutoRecon" "https://github.com/CroweCybersecurity/ad-ldap-enum"
                        "https://github.com/nyxgeek/o365recon" "https://github.com/davidtavarez/pwndb"
                        "https://github.com/internetwache/GitTools" "https://github.com/dirkjanm/ldapdomaindump"
                        "https://github.com/hegusung/RPCScan" "https://github.com/smicallef/spiderfoot"
                        "https://github.com/fleetcaptain/Turbolist3r" "https://github.com/ropnop/windapsearch"
                        "https://github.com/HightechSec/git-scanner" "https://github.com/nccgroup/ScoutSuite"
                        "https://github.com/ffuf/ffuf" "https://github.com/sc1341/InstagramOSINT"
                        "https://github.com/twintproject/twint" "https://github.com/projectdiscovery/httpx"
                        "https://github.com/sensepost/gowitness")
    ["forensics"]=("https://github.com/volatilityfoundation/volatility3" "https://github.com/esrlabs/chipmunk"
                   "https://github.com/Velocidex/velociraptor")
    ["post-exploitation"]=("https://github.com/BloodHoundAD/BloodHound" "https://github.com/Hackplayers/evil-winrm"
                           "https://github.com/GoFetchAD/GoFetch" "https://github.com/zerosum0x0/koadic"
                           "https://github.com/RedTeamOperations/PivotSuite" "https://github.com/byt3bl33d3r/SILENTTRINITY"
                           "https://github.com/BlackArch/webshells" "https://github.com/S3cur3Th1sSh1t/WinPwn"
                           "https://github.com/NetSPI/PowerUpSQL" "https://github.com/BC-SECURITY/Starkiller")
    ["priv-escalation"]=("https://github.com/Mebus/cupp" "https://github.com/ohpe/juicy-potato" "https://github.com/rebootuser/LinEnum"
                         "https://github.com/jondonas/linux-exploit-suggester-2" "https://github.com/TsukiCTF/Lovely-Potato"
                         "https://github.com/Hackndo/lsassy" "https://github.com/foxglovesec/Potato"
                         "https://github.com/danielmiessler/SecLists" "https://github.com/c4b3rw0lf/wordlist-collection"
                         "https://github.com/mchoji/winrm-brute" "https://github.com/carlospolop/PEASS-ng"
                         "https://github.com/unode/firefox_decrypt" "https://github.com/D4Vinci/elpscrk")
    ["vuln-assessment/infra"]=("https://github.com/mitre/caldera.git" "https://github.com/drwetter/testssl.sh"
                               "https://github.com/redcanaryco/atomic-red-team" "https://github.com/robertdavidgraham/rdpscan")
    ["vuln-assessment/web"]=("https://github.com/0ang3el/aem-hacker")
    ["malware-analysis"]=("https://github.com/JusticeRage/Manalyze" "https://github.com/secrary/SSMA" "https://github.com/decalage2/balbuzard"
                          "https://github.com/CYB3RMX/Qu1cksc0pe" "https://github.com/kevthehermit/RATDecoders"
                          "https://github.com/Te-k/pafishmacro" "https://github.com/fireeye/capa" "https://github.com/JohnLaTwC/ScrambledExif"
                          "https://github.com/fireeye/rvmi" "https://github.com/danielplohmann/apiscout" "https://github.com/viper-framework/viper"
                          "https://github.com/CALeeIII/Office-vba-detector" "https://github.com/viper-framework/viper"
                          "https://github.com/hasherezade/pe-sieve")
    ["reverse-engineering"]=("https://github.com/skylot/jadx" "https://github.com/NationalSecurityAgency/ghidra" "https://github.com/juj/emsdk"
                             "https://github.com/radareorg/cutter" "https://github.com/0vercl0k/BDDisasm"
                             "https://github.com/0vercl0k/BDEmu" "https://github.com/gdbinit/Gdbinit"
                             "https://github.com/DavidBuchanan314/ddwrt-emu" "https://github.com/IOActive/FileFormatFuzzing"
                             "https://github.com/googleprojectzero/fuzzilli" "https://github.com/googleprojectzero/fuzzilli"
                             "https://github.com/longld/peda" "https://github.com/sashs/ropper"
                             "https://github.com/secure-software-engineering/phasar" "https://github.com/0vercl0k/BDEmu"
                             "https://github.com/0vercl0k/BDDisasm")
    ["iot"]=("https://github.com/firmadyne/firmadyne" "https://github.com/attify/firmware-analysis-toolkit"
             "https://github.com/mame82/LOGITacker" "https://github.com/reverse-shell/routersploit")
    ["mobile"]=("https://github.com/MobSF/Mobile-Security-Framework-MobSF" "https://github.com/vincentcox/StaCoAn" 
                "https://github.com/tanprathan/MobileApp-Pentest-Cheatsheet" "https://github.com/vavkamil/Information-Security-Cheatsheets")
    ["social-engineering"]=("https://github.com/gophish/gophish" "https://github.com/chrismaddalena/Goreport")
)

# Iterate over categories and tools
for category in "${!tools[@]}"; do
    check_directory "$base_dir/$category"
    cd "$base_dir/$category"
    for url in ${tools[$category]}; do
        # Parse out repo name from URL for directory
        repo_name=$(basename $url .git)
        clone_or_pull $url $repo_name
    done
done
